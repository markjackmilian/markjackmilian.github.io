Bridge.assembly("Bridge.Messenger",function(){"use strict";Bridge.define("Bridge.Messenger.IMessenger",{$kind:"interface"});Bridge.define("Bridge.Messenger.Messenger",{inherits:[Bridge.Messenger.IMessenger],fields:{_calls:null},alias:["Send$1","Bridge$Messenger$IMessenger$Send$1","Send","Bridge$Messenger$IMessenger$Send","Subscribe$1","Bridge$Messenger$IMessenger$Subscribe$1","Subscribe","Bridge$Messenger$IMessenger$Subscribe","Unsubscribe$1","Bridge$Messenger$IMessenger$Unsubscribe$1","Unsubscribe","Bridge$Messenger$IMessenger$Unsubscribe","ResetMessenger","Bridge$Messenger$IMessenger$ResetMessenger"],ctors:{init:function(){this._calls=new(System.Collections.Generic.Dictionary$2(System.Object,System.Collections.Generic.List$1(System.Object)))}},methods:{Send$1:function(TSender,TArgs,sender,message,args){if(sender==null)throw new System.ArgumentNullException("sender");this.InnerSend(message,TSender,TArgs,sender,args)},Send:function(TSender,sender,message){if(sender==null)throw new System.ArgumentNullException("sender");this.InnerSend(message,TSender,null,sender,null)},Subscribe$1:function(TSender,TArgs,subscriber,message,callback,source){if(source===void 0&&(source=Bridge.getDefaultValue(TSender)),subscriber==null)throw new System.ArgumentNullException("subscriber");if(Bridge.staticEquals(callback,null))throw new System.ArgumentNullException("callback");var wrap=function(sender,args){var send=Bridge.cast(sender,TSender);(source==null||Bridge.referenceEquals(send,source))&&callback(Bridge.cast(sender,TSender),Bridge.cast(Bridge.unbox(args),TArgs))};this.InnerSubscribe(subscriber,message,TSender,TArgs,wrap)},Subscribe:function(TSender,subscriber,message,callback,source){if(source===void 0&&(source=Bridge.getDefaultValue(TSender)),subscriber==null)throw new System.ArgumentNullException("subscriber");if(Bridge.staticEquals(callback,null))throw new System.ArgumentNullException("callback");var wrap=function(sender){var send=Bridge.cast(sender,TSender);(source==null||Bridge.referenceEquals(send,source))&&callback(Bridge.cast(sender,TSender))};this.InnerSubscribe(subscriber,message,TSender,null,wrap)},Unsubscribe$1:function(TSender,TArgs,subscriber,message){this.InnerUnsubscribe(message,TSender,TArgs,subscriber)},Unsubscribe:function(TSender,subscriber,message){this.InnerUnsubscribe(message,TSender,null,subscriber)},ResetMessenger:function(){this._calls.clear()},InnerSend:function(message,senderType,argType,sender,args){var $t,key,actions,actionsCopy,action;if(message==null)throw new System.ArgumentNullException("message");if((key={item1:message,item2:senderType,item3:argType},this._calls.containsKey(key))&&(actions=this._calls.get(key),actions!=null&&System.Linq.Enumerable.from(actions).any())){actionsCopy=System.Linq.Enumerable.from(actions).toList(System.Object);$t=Bridge.getEnumerator(actionsCopy);try{while($t.moveNext())action=$t.Current,actions.contains(action)&&action.item2(sender,args)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}}},InnerSubscribe:function(subscriber,message,senderType,argType,callback){var key,value,list;if(message==null)throw new System.ArgumentNullException("message");key={item1:message,item2:senderType,item3:argType};value={item1:subscriber,item2:callback};this._calls.containsKey(key)?this._calls.get(key).add(value):(list=function(_o1){return _o1.add(value),_o1}(new(System.Collections.Generic.List$1(System.Object))),this._calls.set(key,list))},InnerUnsubscribe:function(message,senderType,argType,subscriber){var $t,key,toremove,tuple;if(subscriber==null)throw new System.ArgumentNullException("subscriber");if(message==null)throw new System.ArgumentNullException("message");if(key={item1:message,item2:senderType,item3:argType},this._calls.containsKey(key)){toremove=System.Linq.Enumerable.from(this._calls.get(key)).where(function(tuple){return Bridge.referenceEquals(tuple.item1,subscriber)});$t=Bridge.getEnumerator(toremove);try{while($t.moveNext())tuple=$t.Current,this._calls.get(key).remove(tuple)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}System.Linq.Enumerable.from(this._calls.get(key)).any()||this._calls.remove(key)}}}})});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICJCcmlkZ2UuTWVzc2VuZ2VyLm1pbi5qcyIsCiAgInNvdXJjZVJvb3QiOiAiIiwKICAic291cmNlcyI6IFtdLAogICJuYW1lcyI6IFtdLAogICJtYXBwaW5ncyI6ICIiLAogICJzb3VyY2VzQ29udGVudCI6IFtdCn0K
